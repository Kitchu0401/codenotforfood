# Search Reliability Engineering: 지진에도 흔들리지 않는 네이버 검색 시스템 by 김재헌 (Naver Search & Solution)

SRE(Site Reliability Engineering)란: 글로벌 스케일의 서비스에서 시스템의 신뢰성을 보장하기 위한 기술 분야, 방법론, 문화

사실 시스템 구조적 측면에서의 장에 방어를 생각했는데, 실제 데이터와 방법론 활용 사례를 공유하는 세션이었음

내용은 흥미로웠는데 발표자분이 아쉽다 ㅜ

## 네이버 검색의 목표

- 많은 사용자가 한꺼번에 검색해도 문제가 없어야한다 - 대용량 처리
- 짧은 시간 안에 사용자에게 응답을 돌려줄 수 있어야한다 - 짧은 대기시간

장애가 일어나지 않는 것 -> 장애 예방 활동이 결국 중요하다

## SRE의 난제

장애 예방 활동이 얼마나 비용 측면에서 효율적인지?

장애가 발생하지 않았을 때 예방 활동 덕분이라는걸 어떻게 증명하는지?

시스템이 거대해질수록..

- 장애의 핀포인트 추적의 어려움
- 장애의 파급 범위 확정의 어려움
- 장애의 복구 완료 후 구성 요소의 정상화 확인의 어려움

네이버 검색 시스템의 SRE

- 모든 검색서비스 정상 동작
- 1년 10분 이하의 다운타임
- 고비용 사후처리 대신 저비용 사전처리

## SRE 도입 전 상황

시스템 운영 지표 관측

시스템과 서비스가 커지면서 관측이 비효율적이 됨

그래서:

- 서비스 ID 발급: 이전에도 있었으나, 서비스군 별 일관성이 없었음
- 구조 가시화
- 성능 / 비용 측정

## 네이버 검색 시스템만의 가용량 지표 개발

기존엔 단순하게 "다운 타임 / 가동 타임" 으로 계산 (?)

- 부하 증가 배수: 한 친구가 죽으면 나머지 친구들은?
- 최대 가용 배수: 한 명이 최대 몇 배까지? 여유
- 임계 상황 판단: 부하 증가 배수 > 최대 가용 배수

가용량 경보 발생시 각 시스템 담당자에게 전달함으로써 임계 상황 발생 횟수 대폭 감소

검색시스템 통합 대시보드 개발 및 운영

결국, SRE 활동의 기본적인 프로세스는:

1. 새로운 지표 개발
2. 관제 범위 확대
3. 시스템 개발
4. 새로운 방법론 개발

## 경보 피로

SRE 시스템의 커버리지가 커지면서, 경보 폭탄 이슈

거짓 경보를 판별하기 위한 자동 경보 분석

- False Negative
- False Positive

  - 경험칙: 그래프만 보고도 ok, but 개인능력차 존재
  - 경보 분석 자동화

자동 경보 분석 예제

그래프 모양을 보고 판단 할 수 있는 경우: 그래프의 기울기를 부호로 치환 후, 패턴 매칭으로 감지

지표 데이터의 유사ㅅ도를 보고 판단 할 수 있는 경우: 그래프의 코사인 유사도를 확인 (< 0.975?)

## SRE만의 핵심 철학

거시적 관점에서의 분석을!

Macro Analysis: 연계되어 돌아가는 서비스가 많아졌기 때문에, 외부 요인들까지 고려하여 종합적으로 분석

Blackbox Monitoring: 시스템의 전후관계를 거시적으로 파악 후 장애 여부 판별

## 실제 사례 소개 by 손주식

기본적으로 네이버 검색시스템의 트래픽은 사람의 생체주기를 따라감 (주일별 / 시간대별): 트래픽 패턴을 장애 관제에 적극 활용

패턴에서 벗어나는 검색 트래픽을 anomaly로 규정, 지진 또는 올림픽, 월드컵 등 특수 이벤트 발생 시 관찰됨

데이터는 항상 재미있다

그 외:

- 개편과 버전 변경
- 분석용 데이터 수집 / 부하 테스트
- 지표 수집 문제

## Search Reliability Engineer

해당 분야에 종사하는 엔지니어들의 고민:

- 방어적인 업무 특성상 스트레스가 과도하게 누적됨
- 엔지니어의 심리적, 정신적 안정감도 시스템의 Reliability에 영향을 줌

Incident 발생시 필요한 두 가지 역할의 정의

- IC(Incident Commander): 전체 Incident 통제 / 상황 판단 / 의사 결정
- Scribe: 지표 수집 / 정리, 시간대별 상황 기록, 전파
- 챗봇 / 메신저 적극 활용

비난 없는 사후분석 (Blameless Postmortem): 감정 x / 사실 기반 분석 o

SRE 홍보 활동
