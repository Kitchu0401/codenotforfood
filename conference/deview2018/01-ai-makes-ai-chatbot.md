# 인공지능이 인공지능 챗봇을 만든다 by 이재원 (Naver)

네이버에서 구축한 챗봇의 자연어 처리 구축 과정을 설명하는 세션

일반적으로 머신러닝의 과정은 모델 구축 > 시나리오를 산정한 데이터 투입 > 평가의 반복이라고 알고있었는데

시나리오에 따른 말뭉치 데이터셋의 분류와 모델 튜닝도 

## Chatbot에 대해

제대로 작동하지 않는 챗봇이 수요가 증가하는 현황

## 스스로 언어를 배우는 인공지능 챗봇

언어 별 일반하의 어려움 (한국어 영어 중국어)

사람이 실제로 언어를 배우는 과정은? (눈, 귀 > 두뇌에서 분석 > 파악 > 실생활에서 적용)

인공지능의 언어 학습은? (말뭉치 데이터 > 주변 단어 > feature추출)

> 토크나이징 - 태깅 등의 기본적인 언어 처리 프로세스에 대해 설명해주심

### 인공지능이 언어를 배우는 과정: Vector Representation

Gtanford Glove, Facebook fastText, Naver Global Embedding Vector

Vector Space에 문장의 Embedding Vector를 적절하게 배치

Embedding Vector가 가까울수록 문장이 같은 의미, 멀수록 다른 의미

도메인 별 말뭉치

스스로 말뭉치를 만들고, 학습하고, 분류할 수 있지 않을까?

### AutoML

자신의 환경에 대해 학습하는 코드와 알고리즘을 스스로 생성하는 신경망 프로세스

말뭉치 > 전처리 > 피처 고르고, 추출하고 > 모델을 고르고 > 파라미터 최적화 > 모델 평가

## 좋은 말뭉치 > 좋은 선생님

말뭉치가 챗봇의 품질을 결정

스스로 학습 - 평가 - 수정을 반복하는 모델

코드는 이미 공개, 하지만 내가 돌리면 안나와 - 하이퍼 파라미터 튜닝 등의 작업을 반복 <- 오토엠엘이 해줘요

### QA말뭉치 만으로는 모델 구축이 쉽지 않음

방대한 말뭉치의 효율적 관리 > 클러스터링을 활용한 말뭉치의 특성 기반 분류

하이퍼 파라미터 튜닝 > 모델 튜닝

### Compnay AI Chatbot Builder Framework

1. 피처 추출 라이브러리

2. 쿼리 전처리

3. 아이얼로그 모델 기반 답변 예측

사람이 대화를 배워가는 과정과 가장 유사한 형태로 모델을 구성

### N-hot Feature

Token Index + POS + EOMI

쿼리 > 모델들의 답변을 앙상블 > Akka 클러스터링

## 실제 인공지능 챗봇의 성능(말하기 실력은?)

챗봇들 간의 성능은 평준화, 인공지능 스스로 평가하고 개선하는 모습을 보여dream

챗봇 성능 평가 기준 -> 사람이 평가

- 발화의도 파악

- 대명사 지칭과 사용자가 ㅇ청하는 것

- 답변의 품질

사람이 하기 힘든 일이라, 기계에게 맡긴다

- 클러스터링

Embedding Vector가 유사한 쿼리라고 가정하고, 평가에 활용

군집 간 분산 최대화 / 군집 내 분산 최소화

클러스터링을 할 때마다 평가셋 제작해 자동학습 점수가 최대가 되는 클러스터링 결과 선택

- 하이퍼 파라미터 자동평가

클러스터링이 잘 되었다는 가정 하에 모델을 바꿔가며 하이퍼파라미터 튜닝 (코사인 유사도)

# 클러스터링 / 하이퍼 파라미터 튜닝

## 클러스터링

기본 말뭉치를 챗봇 시나리오로 변환

4개의 클러스터링 알고리즘 중 K-means 클러스터링 - 같은 문장ㅇ임에도 속한 말뭉치마다 다르게 생성되는 ev 특징 반영

사람이 직접 시나리오를 관리한 모델의 성능과 비슷한 성능의 자동화된 시나리오를 생성

다양한 베리에이션의 쿼리를 쿼리를 원형복원하는게 중요

## Seq2Seq based retrieval model

# 최종 모델

DEVIEW 2018 QA 기반으로 사전에 준비된 시나리오를 타고 답변을 도출

백그라운드에서 AutoML을 통한 모델 개선 진행

##

기본 모델 / 아키텍쳐로도 가능

언어별 피쳐

다수의 베이스 모델 앙상블

많은 실험은 테스트 프레임웍으로 해결

# 그외 +

챗봇과 IR시스템의 차이는 무엇일까